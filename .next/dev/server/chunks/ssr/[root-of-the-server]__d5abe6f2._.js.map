{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/dredog/Desktop/Bicycle%20Ambulance/app/components/HeadphoneScroll.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  motion,\n  useMotionValueEvent,\n  useScroll,\n  useSpring,\n  useTransform,\n} from \"framer-motion\";\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\n\ntype HeadphoneScrollProps = {\n  frames: string[];\n};\n\nconst clamp = (value: number, min: number, max: number) =>\n  Math.min(max, Math.max(min, value));\n\nexport default function HeadphoneScroll({ frames }: HeadphoneScrollProps) {\n  const containerRef = useRef<HTMLDivElement | null>(null);\n  const canvasRef = useRef<HTMLCanvasElement | null>(null);\n  const imagesRef = useRef<HTMLImageElement[]>([]);\n  const rafRef = useRef<number | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  const frameUrls = useMemo(() => frames, [frames]);\n  const frameCount = frameUrls.length;\n\n  const { scrollYProgress } = useScroll({\n    target: containerRef,\n    offset: [\"start start\", \"end end\"],\n  });\n\n  const animationProgress = useTransform(\n    scrollYProgress,\n    [0, 0.02, 1],\n    [0, 0, 1],\n    { clamp: true }\n  );\n  const smoothProgress = useSpring(scrollYProgress, {\n    stiffness: 200,\n    damping: 30,\n    mass: 0.2,\n  });\n\n  const resizeCanvas = useCallback(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const dpr = window.devicePixelRatio || 1;\n    const { width, height } = canvas.getBoundingClientRect();\n    canvas.width = Math.round(width * dpr);\n    canvas.height = Math.round(height * dpr);\n    const ctx = canvas.getContext(\"2d\");\n    if (ctx) {\n      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n      ctx.imageSmoothingEnabled = true;\n      ctx.imageSmoothingQuality = \"high\";\n    }\n  }, []);\n\n  const drawFrame = useCallback(\n    (index: number) => {\n      const canvas = canvasRef.current;\n      const ctx = canvas?.getContext(\"2d\");\n      const image = imagesRef.current[index];\n      if (!canvas || !ctx || !image) return;\n\n      const canvasWidth = canvas.clientWidth;\n      const canvasHeight = canvas.clientHeight;\n      const imgRatio = image.width / image.height;\n      const canvasRatio = canvasWidth / canvasHeight;\n\n      let drawWidth = canvasWidth;\n      let drawHeight = canvasHeight;\n\n      if (imgRatio > canvasRatio) {\n        drawWidth = canvasWidth;\n        drawHeight = canvasWidth / imgRatio;\n      } else {\n        drawHeight = canvasHeight;\n        drawWidth = canvasHeight * imgRatio;\n      }\n\n      const offsetX = (canvasWidth - drawWidth) / 2;\n      const offsetY = (canvasHeight - drawHeight) / 2;\n\n      ctx.clearRect(0, 0, canvasWidth, canvasHeight);\n      ctx.drawImage(image, offsetX, offsetY, drawWidth, drawHeight);\n    },\n    []\n  );\n\n  useEffect(() => {\n    if (!frameCount) {\n      setIsLoading(false);\n      return;\n    }\n\n    let isMounted = true;\n    imagesRef.current = new Array(frameCount);\n    let loadedCount = 0;\n\n    frameUrls.forEach((src, index) => {\n      const img = new Image();\n      img.src = src;\n      img.onload = () => {\n        if (!isMounted) return;\n        loadedCount += 1;\n        imagesRef.current[index] = img;\n        if (loadedCount === frameCount) {\n          setIsLoading(false);\n          requestAnimationFrame(() => drawFrame(0));\n        }\n      };\n    });\n\n    return () => {\n      isMounted = false;\n    };\n  }, [drawFrame, frameCount, frameUrls]);\n\n  useEffect(() => {\n    resizeCanvas();\n    drawFrame(0);\n    const handleResize = () => {\n      resizeCanvas();\n      drawFrame(\n        clamp(\n          Math.round(animationProgress.get() * (frameCount - 1)),\n          0,\n          Math.max(0, frameCount - 1)\n        )\n      );\n    };\n    window.addEventListener(\"resize\", handleResize);\n    return () => window.removeEventListener(\"resize\", handleResize);\n  }, [drawFrame, frameCount, resizeCanvas, animationProgress]);\n\n  useMotionValueEvent(animationProgress, \"change\", (latest) => {\n    if (!frameCount || isLoading) return;\n    const frameIndex = clamp(\n      Math.round(latest * (frameCount - 1)),\n      0,\n      frameCount - 1\n    );\n\n    if (rafRef.current) cancelAnimationFrame(rafRef.current);\n    rafRef.current = requestAnimationFrame(() => drawFrame(frameIndex));\n  });\n\n  const opacityWelcomeStart = useTransform(\n    smoothProgress,\n    [0, 0.08],\n    [1, 0]\n  );\n  const welcomeYStart = useTransform(smoothProgress, [0, 0.08], [0, -40]);\n  const opacityTitle = useTransform(\n    smoothProgress,\n    [0.12, 0.2, 0.3],\n    [0, 1, 0]\n  );\n  const opacityLeft = useTransform(\n    smoothProgress,\n    [0.32, 0.42, 0.52],\n    [0, 1, 0]\n  );\n  const opacityRight = useTransform(\n    smoothProgress,\n    [0.56, 0.66, 0.76],\n    [0, 1, 0]\n  );\n  const progressScale = useTransform(smoothProgress, [0, 1], [0, 1]);\n  const callNowOpacity = useTransform(smoothProgress, [0.6, 0.7], [0, 1]);\n\n  return (\n    <section ref={containerRef} className=\"relative h-[400vh] w-full\">\n      <canvas\n        ref={canvasRef}\n        className=\"sticky top-0 h-screen w-full bg-[#050505]\"\n      />\n\n      <div className=\"pointer-events-none absolute inset-0 flex h-screen items-center justify-center\">\n        {isLoading && (\n          <div className=\"flex items-center justify-center rounded-full border border-white/10 bg-white/5 px-6 py-3 text-xs uppercase tracking-[0.4em] text-white/60\">\n            <span className=\"mr-3 inline-block h-4 w-4 animate-spin rounded-full border-2 border-white/40 border-t-transparent\" />\n            Loading sequence\n          </div>\n        )}\n      </div>\n\n      <div className=\"pointer-events-none absolute inset-0 z-10 bg-[url('data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%2250%22 height=%2250%22 viewBox=%220 0 50 50%22%3E%3Cfilter id=%22n%22 x=%220%22 y=%220%22 width=%22100%25%22 height=%22100%25%22%3E%3CfeTurbulence type=%22fractalNoise%22 baseFrequency=%220.8%22 numOctaves=%221%22 stitchTiles=%22stitch%22/%3E%3C/filter%3E%3Crect width=%2250%22 height=%2250%22 filter=%22url(%23n)%22 opacity=%220.12%22/%3E%3C/svg%3E')] opacity-25 mix-blend-soft-light\" />\n\n      <div className=\"pointer-events-none sticky top-0 z-20 flex h-screen w-full items-end justify-center pb-6\">\n        <div className=\"h-1 w-[60vw] max-w-lg rounded-full bg-white/10\">\n          <motion.div\n            style={{ scaleX: progressScale, transformOrigin: \"left\" }}\n            className=\"h-full rounded-full bg-white/50\"\n          />\n        </div>\n      </div>\n\n      <motion.div\n        style={{ opacity: callNowOpacity }}\n        className=\"pointer-events-none sticky top-6 z-20 mx-auto flex w-full justify-center\"\n      >\n        <div className=\"rounded-full border border-white/15 bg-white/5 px-5 py-2 text-xs uppercase tracking-[0.3em] text-white/70\">\n          Call Now\n        </div>\n      </motion.div>\n\n      <motion.div\n        style={{ opacity: opacityWelcomeStart, y: welcomeYStart }}\n        className=\"pointer-events-none sticky top-0 z-20 flex h-screen w-full items-center justify-center text-center\"\n      >\n        <h1 className=\"text-balance text-4xl font-semibold tracking-tight text-white/90 md:text-6xl\">\n          Welcome\n        </h1>\n      </motion.div>\n\n      <motion.div\n        style={{ opacity: opacityTitle }}\n        className=\"pointer-events-none sticky top-0 z-20 flex h-screen w-full items-center justify-center text-center\"\n      >\n        <h1 className=\"text-balance text-3xl font-semibold tracking-tight text-white/90 md:text-5xl\">\n          Bicycle Ambulance Santa Monica.\n        </h1>\n      </motion.div>\n\n      <motion.div\n        style={{ opacity: opacityLeft }}\n        className=\"pointer-events-none sticky top-0 z-20 flex h-screen w-full items-center justify-start px-6 md:px-16\"\n      >\n        <div className=\"max-w-sm text-left\">\n          <p className=\"text-xs uppercase tracking-[0.4em] text-white/50\">\n            Story\n          </p>\n          <h2 className=\"mt-3 text-2xl font-semibold tracking-tight text-white/90 md:text-4xl\">\n            Serving Santa Monica Since 1995\n          </h2>\n        </div>\n      </motion.div>\n\n      <motion.div\n        style={{ opacity: opacityRight }}\n        className=\"pointer-events-none sticky top-0 z-20 flex h-screen w-full items-center justify-end px-6 md:px-16\"\n      >\n        <div className=\"max-w-sm text-right\">\n          <p className=\"text-xs uppercase tracking-[0.4em] text-white/50\">\n            Service\n          </p>\n          <h2 className=\"mt-3 text-2xl font-semibold tracking-tight text-white/90 md:text-4xl\">\n            Top Tier Service\n          </h2>\n        </div>\n      </motion.div>\n\n    </section>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}